const n=".0123456789";function l(n){const l=n.split(".").map((function(n){if(n.length>3)return null;if(n.startsWith("0")&&n.length>1)return null;const l=parseInt(n,10);return l<0||l>255?null:n})).filter((n=>!!n));return 4===l.length?l.join("."):null}const t=n+":abcdefABCDEF";function e(n){if(n.includes(" ")||n.includes(":::"))return null;const t=n.split(":"),e=t[t.length-1];if(e.includes(".")){let n=l(e);if(null===n)return null;let u=n.split(".").map((n=>parseInt(n,10).toString(16).padStart(2,"0")));t.splice(t.length-1,1,u[0]+u[1],u[2]+u[3])}if(t.some((n=>n.length>4)))return null;if(t.length<3||t.length>8)return null;let u=t.findIndex((n=>""===n));if(-1!==u){const n=8-t.length,l=Array(n).fill("");t.splice(u,0,...l)}else if(8!=t.length)return null;return 8!==t.length?null:t.map((n=>n.padStart(4,"0").toLowerCase())).join(":")}function u(n,l){for(let t=0;t<n.length;t++)if(!l.includes(n[t]))return!0;return!1}function r(r){return"string"!=typeof r||r.length<3||r.length>39?null:r.includes(".")&&!r.includes(":")?u(r,n)?null:l(r):r.includes(":")?u(r,t)?null:e(r):null}export{r as parseIp,l as parseIpv4,e as parseIpv6};
